version: 2.1

executors:
  helm: 
    docker:
      - image: alpine/helm
commands:
   repo_add:
     description: "Adding helm repo"
     steps: 
       - run: |       
           helm repo add myrepo https://devopsrajpurohit.github.io/helm/
   package:
     description: "getting chart name from tag"
     steps: 
       - run: |       
           helm package  $chart_path   
jobs:
  build:
    executor: helm
    steps:
     - checkout 
     - repo_add
     - package

workflows:
  helm-chart-release:
    jobs:
      - build:
          context: helm
         


    